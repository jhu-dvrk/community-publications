<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dVRK Community Publications</title>
    <script src="https://cdn.jsdelivr.net/npm/bibtex-parse-js@0.0.24/bibtexParse.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="config.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="app">
        <header>
            <div class="container">
                <div class="header-content">
                    <img src="dvrk-logo.png" alt="dVRK Logo" class="logo">
                    <h1>Community Publications</h1>
                </div>
                <p class="subtitle">da Vinci Research Kit ‚Ä¢ {{ publications.length }} publications</p>
                <div class="header-nav">
                    <a href="analytics.html" class="nav-btn">üìä View Analytics</a>
                </div>
            </div>
        </header>

        <main class="container">
            <!-- Search and Filter Section -->
            <div class="controls">
                <div class="search-box">
                    <input v-model="searchQuery" type="text"
                        placeholder="Search publications by title, author, or keywords..." class="search-input">
                </div>

                <div class="filters">
                    <select v-model="startYear" class="filter-select year-select">
                        <option v-for="year in availableStartYears" :key="year" :value="year">
                            From {{ year }}
                        </option>
                    </select>

                    <select v-model="endYear" class="filter-select year-select">
                        <option v-for="year in availableEndYears" :key="year" :value="year">
                            To {{ year }}
                        </option>
                    </select>

                    <select v-model="selectedType" class="filter-select">
                        <option value="">All Types</option>
                        <option value="article">Journal Articles</option>
                        <option value="inproceedings">Conference Papers</option>
                        <option value="incollection">Book Chapters</option>
                        <option value="misc">Other</option>
                    </select>

                    <select v-model="selectedField" class="filter-select">
                        <option value="">All Research Areas</option>
                        <option v-for="field in availableFields" :key="field" :value="field">
                            {{ field }}
                        </option>
                    </select>

                    <select v-model="selectedDataType" class="filter-select">
                        <option value="">All Data Types</option>
                        <option v-for="dataType in availableDataTypes" :key="dataType" :value="dataType">
                            {{ dataType }}
                        </option>
                    </select>

                    <button @click="resetFilters" class="reset-btn">Reset Filters</button>
                    <button @click="downloadBibtex" class="download-btn">‚¨á Download BibTeX ({{
                        filteredPublications.length }})</button>
                </div>
            </div>

            <!-- Statistics -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">{{ filteredPublications.length }}</div>
                    <div class="stat-label">Publications</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ totalAuthors }}</div>
                    <div class="stat-label">Authors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ yearRange }}</div>
                    <div class="stat-label">Year Range</div>
                </div>
            </div>

            <!-- Publications List -->
            <div class="publications-list">
                <div v-for="(pub, index) in paginatedPublications" :key="pub.id" class="publication-card">
                    <h3 class="pub-title">{{ pub.title }}</h3>

                    <p class="pub-authors" v-if="pub.author">
                        {{ formatAuthors(pub.author) }}
                    </p>

                    <p class="pub-venue" v-if="pub.journal || pub.booktitle">
                        <strong>{{ pub.journal || pub.booktitle }}</strong>
                        <span v-if="pub.volume"> Vol. {{ pub.volume }}</span>
                        <span v-if="pub.number">, No. {{ pub.number }}</span>
                        <span class="pub-meta"> ({{ pub.year }}, {{ formatType(pub.type) }})</span>
                    </p>

                    <div class="pub-tags" v-if="pub.research_field">
                        <span v-for="field in parseFields(pub.research_field)" :key="field"
                            :title="getFieldDescription(field)" class="tag">
                            {{ field }}
                        </span>
                    </div>

                    <div class="pub-tags" v-if="pub.data_type">
                        <span v-for="dataType in parseDataTypes(pub.data_type)" :key="dataType"
                            :title="getDataTypeDescription(dataType)" class="tag tag-data">
                            {{ dataType }}
                        </span>
                    </div>

                    <div class="pub-footer">
                        <a v-if="pub.url" :href="pub.url" target="_blank" class="pub-link">
                            üìÑ URL
                        </a>
                        <a v-if="pub.doi" :href="'https://doi.org/' + pub.doi" target="_blank" class="pub-link">
                            üîó DOI
                        </a>
                        <a v-if="pub.ieeexplore" :href="pub.ieeexplore" target="_blank" class="pub-link">
                            üìö IEEE Xplore
                        </a>
                        <a v-if="pub.semanticscholar" :href="pub.semanticscholar" target="_blank" class="pub-link">
                            üîç Semantic Scholar
                        </a>
                        <a v-if="pub.arxiv" :href="pub.arxiv" target="_blank" class="pub-link" style="background-color: #4f46e5;">
                            arXiv
                        </a>
                        <a v-if="pub.openaccesspdf" :href="pub.openaccesspdf" target="_blank" class="pub-link" style="background-color: #dc2626;">
                            üîì PDF
                        </a>
                        <button v-if="pub.abstract" @click="toggleAbstract(pub)" class="bibtex-btn">
                            {{ pub.showAbstract ? '‚úï Hide Abstract' : 'üìù Abstract' }}
                        </button>
                        <button @click="toggleBibtex(pub)" class="bibtex-btn">
                            {{ pub.showBibtex ? '‚úï Hide BibTeX' : 'üìã BibTeX' }}
                        </button>
                    </div>

                    <div v-if="pub.showAbstract" class="bibtex-container" style="background: #f9fafb; border-color: #e5e7eb;">
                        <p class="bibtex-text" style="white-space: pre-wrap; font-family: sans-serif;">{{ pub.abstract }}</p>
                    </div>

                    <div v-if="pub.showBibtex" class="bibtex-container">
                        <pre class="bibtex-text">{{ pub.bibtexText }}</pre>
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination" v-if="totalPages > 1">
                <button @click="currentPage--" :disabled="currentPage === 1" class="page-btn">
                    Previous
                </button>
                <span class="page-info">
                    Page {{ currentPage }} of {{ totalPages }}
                </span>
                <button @click="currentPage++" :disabled="currentPage === totalPages" class="page-btn">
                    Next
                </button>
            </div>
        </main>

        <footer>
            <div class="container">
                <p>dVRK Publications Database | {{ publications.length }} total publications</p>
                <p>Data source: <a href="https://github.com/jhu-dvrk" target="_blank">dVRK
                        Project</a></p>
            </div>
        </footer>
    </div>

    <script src="app.js"></script>
</body>

</html>